<html lang="en"></html>
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
     <script type="text/javascript" src="/js/jquery.min.js"></script>
 
     <script type="text/javascript" src="/js/moment.min.js"></script>
     <script type="text/javascript" src="/js/daterangepicker.min.js"></script>
     <link rel="stylesheet" type="text/css" href="/css/daterangepicker.css" />
 
     <link rel="stylesheet" href="/css/datatables.min.css">
     <script src="/js/datatables.min.js"></script>
 
     <title>ðŸŽ¨ Kontrola paletky</title>
     <style>
         html {
             background-color: #222;
             color: #ddd;
             font-family: 'Courier New', Courier, monospace;
         }
         a:link, a:visited, a:hover, a:active {
             color: #ddd;
         }
     </style>
 </head>
 <body>
     <p style="display: inline;">ðŸŽ¨ Kontrola paletky</p>
     <input type="text" name="daterange">
     <div>
         <table id="myTable" class="nowrap">
             <thead>
                 <tr>
                     <th>ID</th>
                     <th>SYS TIME</th>
                     <th>ID INT</th>
                     <th>ID STRING</th>
                     <th>SARZA GM</th>
                     <th>SARZA HOUSING</th>
                     <th>HOUSING STATUS</th>
                     <th>GM STATUS</th>
                     <th>DUMMY STATUS</th>
                     <th>A ORIENTACIA HODNOTA</th>
                     <th>A ORIENTACIA STRING</th>
                     <th>A PRESTREK HODNOTA</th>
                     <th>B ORIENTACIA HODNOTA</th>
                     <th>B ORIENTACIA STRING</th>
                     <th>B PRESTREK HODNOTA</th>
                     <th>STATUS ORIENTACIA</th>
                     <th>STATUS PRESTREK</th>
                     <th>DATETIME</th>
                 </tr>
             </thead>
         </table>
     </div>
 </body>
 
 <script>
     let table = null
     let curStart = moment().startOf('day').format('YYYY-MM-DD')
     let curEnd = moment().endOf('day').format('YYYY-MM-DD')
 
     const formatTime = timeStr => timeStr ? timeStr.replace("Z", "").replace("T", " ").substring(0, timeStr.indexOf('.')) : timeStr
 
     const addData = () => {
         if (table) table.destroy()
         const url = `/api/kontrola-paletky?start=${curStart}&end=${curEnd}`
         table = $('#myTable').DataTable({
             ajax: {
                 url: url,
                 dataSrc: ''
             },
             order: [[0, 'desc']],
             columns: [
                 { data: "id"},
                 { data: "sys_time", render: formatTime },
                 { data: "id_int" },
                 { data: "id_string" },
                 { data: "sarza_gm" },
                 { data: "sarza_housing" },
                 { data: "housing_status" },
                 { data: "gm_status" },
                 { data: "dummy_status" },
                 { data: "a_orientacia_hodnota" },
                 { data: "a_orientacia_string" },
                 { data: "a_prestrek_hodnota" },
                 { data: "b_orientacia_hodnota" },
                 { data: "b_orientacia_string" },
                 { data: "b_prestrek_hodnota" },
                 { data: "status_prestrek" },
                 { data: "status_prestrek" },
                 { data: "datetime", render: formatTime }
             ],
             pageLength: 100,
         })
     }
 
     $(document).ready(function () {
         addData()
     })
 
     $(function() {
         $('input[name="daterange"]').daterangepicker({
             startDate: moment().startOf('day'),
             endDate: moment().endOf('day'),
             showCustomRangeLabel: true,
             showWeekNumbers: true
         }, function(start, end, label) {
             const formatedStart = start.format("YYYY-MM-DD")
             const formatedEnd = end.format("YYYY-MM-DD")
             curStart = formatedStart
             curEnd = formatedEnd
             addData()
         });
     });
 </script>
 </html>